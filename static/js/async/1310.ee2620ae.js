"use strict";(self.webpackChunkdelixia=self.webpackChunkdelixia||[]).push([["1310"],{12970:function(e,t,r){r.r(t),r.d(t,{_ExrTextureLoader:()=>F});var n,l,a,i,o,u,f=r(11597),s=r(52409);(n=i||(i={}))[n.NO_COMPRESSION=0]="NO_COMPRESSION",n[n.RLE_COMPRESSION=1]="RLE_COMPRESSION",n[n.ZIPS_COMPRESSION=2]="ZIPS_COMPRESSION",n[n.ZIP_COMPRESSION=3]="ZIP_COMPRESSION",n[n.PIZ_COMPRESSION=4]="PIZ_COMPRESSION",n[n.PXR24_COMPRESSION=5]="PXR24_COMPRESSION",(l=o||(o={}))[l.INCREASING_Y=0]="INCREASING_Y",l[l.DECREASING_Y=1]="DECREASING_Y";let c=function(){let e=new ArrayBuffer(4),t=new Float32Array(e),r=new Uint32Array(e),n=new Uint32Array(512),l=new Uint32Array(512);for(let e=0;e<256;++e){let t=e-127;t<-27?(n[e]=0,n[256|e]=32768,l[e]=24,l[256|e]=24):t<-14?(n[e]=1024>>-t-14,n[256|e]=1024>>-t-14|32768,l[e]=-t-1,l[256|e]=-t-1):t<=15?(n[e]=t+15<<10,n[256|e]=t+15<<10|32768,l[e]=13,l[256|e]=13):t<128?(n[e]=31744,n[256|e]=64512,l[e]=24,l[256|e]=24):(n[e]=31744,n[256|e]=64512,l[e]=13,l[256|e]=13)}let a=new Uint32Array(2048),i=new Uint32Array(64),o=new Uint32Array(64);for(let e=1;e<1024;++e){let t=e<<13,r=0;for(;(8388608&t)==0;)t<<=1,r-=8388608;t&=-8388609,r+=0x38800000,a[e]=t|r}for(let e=1024;e<2048;++e)a[e]=0x38000000+(e-1024<<13);for(let e=1;e<31;++e)i[e]=e<<23;i[31]=0x47800000,i[32]=0x80000000;for(let e=33;e<63;++e)i[e]=0x80000000+(e-32<<23);i[63]=0xc7800000;for(let e=1;e<64;++e)32!==e&&(o[e]=1024);return{floatView:t,uint32View:r,baseTable:n,shiftTable:l,mantissaTable:a,exponentTable:i,offsetTable:o}}();function h(e,t){let r=new Uint8Array(e),n=0;for(;0!=r[t.value+n];)n+=1;let l=new TextDecoder().decode(r.slice(t.value,t.value+n));return t.value=t.value+n+1,l}function p(e,t){let r=e.getInt32(t.value,!0);return t.value+=4,r}function w(e,t){let r=e.getUint32(t.value,!0);return t.value+=4,r}function y(e,t){let r=e.getUint8(t.value);return t.value+=1,r}function d(e,t){let r=e.getUint16(t.value,!0);return t.value+=2,r}function v(e,t){let r=e[t.value];return t.value+=1,r}function b(e,t){let r=e.getFloat32(t.value,!0);return t.value+=4,r}function S(e,t){var r=d(e,t);let n=(31744&r)>>10,l=1023&r;return(r>>15?-1:1)*(n?31===n?l?NaN:1/0:Math.pow(2,n-15)*(1+l/1024):l/1024*6103515625e-14)}function E(e,t){var r=b(e,t);if(Math.abs(r)>65504)throw Error("Value out of range.Consider using float instead of half-float.");r=(0,s.Clamp)(r,-65504,65504),c.floatView[0]=r;let n=c.uint32View[0],l=n>>23&511;return c.baseTable[l]+((8388607&n)>>c.shiftTable[l])}function g(e){for(let t=1;t<e.length;t++){let r=e[t-1]+e[t]-128;e[t]=r}}function A(e,t){let r=0,n=Math.floor((e.length+1)/2),l=0,a=e.length-1;for(;!(l>a)&&(t[l++]=e[r++],!(l>a));){;t[l++]=e[n++]}}function O(e,t,r,n,l){for(;r<e;)t=t<<8|v(n,l),r+=8;return{l:t>>(r-=e)&(1<<e)-1,c:t,lc:r}}function I(e,t,r,n){return{c:e=e<<8|v(r,n),lc:t+=8}}function C(e,t,r,n,l,a,i,o,u){if(e==t){if(n<8){let e=I(r,n,l,a);r=e.c,n=e.lc}let e=r>>(n-=8);if(e=new Uint8Array([e])[0],o.value+e>u)return null;let t=i[o.value-1];for(;e-- >0;)i[o.value++]=t}else{if(!(o.value<u))return null;i[o.value++]=e}return{c:r,lc:n}}let U=Array(59);function x(e){let t=65535&e;return t>32767?t-65536:t}function m(e,t){let r=x(e),n=x(t),l=r+(1&n)+(n>>1);return{a:l,b:l-n}}function M(e,t){let r=65535&t,n=(65535&e)-(r>>1)&65535;return{a:r+n-32768&65535,b:n}}function P(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function R(e){let t=new Uint8Array(function(e){let t=e.byteLength,r=[],n=0,l=new DataView(e);for(;t>0;){let e=l.getInt8(n++);if(e<0){let a=-e;t-=a+1;for(let e=0;e<a;e++)r.push(l.getUint8(n++))}else{t-=2;let a=l.getUint8(n++);for(let t=0;t<e+1;t++)r.push(a)}}return r}(e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size))),r=new Uint8Array(t.length);return g(t),A(t,r),new DataView(r.buffer)}function k(e){let t=e.array.slice(e.offset.value,e.offset.value+e.size),r=fflate.unzlibSync(t),n=new Uint8Array(r.length);return g(r),A(r,n),new DataView(n.buffer)}function N(e){let t=e.array.slice(e.offset.value,e.offset.value+e.size),r=fflate.unzlibSync(t),n=e.lines*e.channels*e.width,l=1==e.type?new Uint16Array(n):new Uint32Array(n),a=0,i=0,o=[,,,,];for(let t=0;t<e.lines;t++)for(let t=0;t<e.channels;t++){let t=0;switch(e.type){case 1:o[0]=a,o[1]=o[0]+e.width,a=o[1]+e.width;for(let n=0;n<e.width;++n)t+=r[o[0]++]<<8|r[o[1]++],l[i]=t,i++;break;case 2:o[0]=a,o[1]=o[0]+e.width,o[2]=o[1]+e.width,a=o[2]+e.width;for(let n=0;n<e.width;++n)t+=r[o[0]++]<<24|r[o[1]++]<<16|r[o[2]++]<<8,l[i]=t,i++}}return new DataView(l.buffer)}function T(e){let t=e.viewer,r={value:e.offset.value},n=new Uint16Array(e.width*e.scanlineBlockSize*(e.channels*e.type)),l=new Uint8Array(8192),a=0,i=Array(e.channels);for(let t=0;t<e.channels;t++)i[t]={},i[t].start=a,i[t].end=i[t].start,i[t].nx=e.width,i[t].ny=e.lines,i[t].size=e.type,a+=i[t].nx*i[t].ny*i[t].size;let o=d(t,r),u=d(t,r);if(u>=8192)throw Error("Wrong PIZ_COMPRESSION BITMAP_SIZE");if(o<=u)for(let e=0;e<u-o+1;e++)l[e+o]=y(t,r);let f=new Uint16Array(65536),s=function(e,t){let r=0;for(let n=0;n<65536;++n)(0==n||e[n>>3]&1<<(7&n))&&(t[r++]=n);let n=r-1;for(;r<65536;)t[r++]=0;return n}(l,f),c=w(t,r);!function(e,t,r,n,l,a){let i=r.value,o=w(t,r),u=w(t,r);r.value+=4;let f=w(t,r);if(r.value+=4,o<0||o>=65537||u<0||u>=65537)throw Error("Wrong HUF_ENCSIZE");let s=Array(65537),c=Array(16384);for(let e=0;e<16384;e++)c[e]={},c[e].len=0,c[e].lit=0,c[e].p=null;let h=n-(r.value-i);if(!function(e,t,r,n,l,a){let i=0,o=0;for(;n<=l;n++){if(t.value-t.value>r)return;let u=O(6,i,o,e,t),f=u.l;if(i=u.c,o=u.lc,a[n]=f,63==f){if(t.value-t.value>r)throw Error("Error in HufUnpackEncTable");let f=(u=O(8,i,o,e,t)).l+6;if(i=u.c,o=u.lc,n+f>l+1)throw Error("Error in HufUnpackEncTable");for(;f--;)a[n++]=0;n--}else if(f>=59){let e=f-59+2;if(n+e>l+1)throw Error("Error in HufUnpackEncTable");for(;e--;)a[n++]=0;n--}}!function(e){for(let e=0;e<=58;++e)U[e]=0;for(let t=0;t<65537;++t)U[e[t]]+=1;let t=0;for(let e=58;e>0;--e){let r=t+U[e]>>1;U[e]=t,t=r}for(let t=0;t<65537;++t){let r=e[t];r>0&&(e[t]=r|U[r]++<<6)}}(a)}(e,r,h,o,u,s),f>8*(n-(r.value-i)))throw Error("Wrong hufUncompress");!function(e,t,r,n){for(;t<=r;t++){let r=e[t]>>6,l=63&e[t];if(r>>l)throw Error("Invalid table entry");if(l>14){let e=n[r>>l-14];if(e.len)throw Error("Invalid table entry");if(e.lit++,e.p){let t=e.p;e.p=Array(e.lit);for(let r=0;r<e.lit-1;++r)e.p[r]=t[r]}else e.p=[,];e.p[e.lit-1]=t}else if(l){let e=0;for(let a=1<<14-l;a>0;a--){let a=n[(r<<14-l)+e];if(a.len||a.p)throw Error("Invalid table entry");a.len=l,a.lit=t,e++}}}}(s,o,u,c),function(e,t,r,n,l,a,i,o,u){let f=0,s=0,c=Math.trunc(n.value+(l+7)/8);for(;n.value<c;){let l=I(f,s,r,n);for(f=l.c,s=l.lc;s>=14;){let h=t[f>>s-14&16383];if(h.len){s-=h.len;let e=C(h.lit,a,f,s,r,n,o,u,i);e&&(f=e.c,s=e.lc)}else{let t;if(!h.p)throw Error("hufDecode issues");for(t=0;t<h.lit;t++){let p=63&e[h.p[t]];for(;s<p&&n.value<c;)f=(l=I(f,s,r,n)).c,s=l.lc;if(s>=p&&e[h.p[t]]>>6==(f>>s-p&(1<<p)-1)){s-=p;let e=C(h.p[t],a,f,s,r,n,o,u,i);e&&(f=e.c,s=e.lc);break}}if(t==h.lit)throw Error("HufDecode issues")}}}let h=8-l&7;for(f>>=h,s-=h;s>0;){let e=t[f<<14-s&16383];if(e.len){s-=e.len;let t=C(e.lit,a,f,s,r,n,o,u,i);t&&(f=t.c,s=t.lc)}else throw Error("HufDecode issues")}}(s,c,e,r,f,u,a,l,{value:0})}(e.array,t,r,c,n,a);for(let t=0;t<e.channels;++t){let e=i[t];for(let r=0;r<i[t].size;++r)!function(e,t,r,n,l,a,i){let o,u,f=i<16384,s=r>l?l:r,c=1;for(;c<=s;)c<<=1;for(c>>=1,o=c,c>>=1;c>=1;){let i,s,h,p,w=(u=0)+a*(l-o),y=a*c,d=a*o,v=n*c,b=n*o;for(;u<=w;u+=d){let l=u,a=u+n*(r-o);for(;l<=a;l+=b){let r=l+v,n=l+y,a=n+v;if(f){let o=m(e[l+t],e[n+t]);i=o.a,h=o.b,s=(o=m(e[r+t],e[a+t])).a,p=o.b,o=m(i,s),e[l+t]=o.a,e[r+t]=o.b,o=m(h,p),e[n+t]=o.a,e[a+t]=o.b}else{let o=M(e[l+t],e[n+t]);i=o.a,h=o.b,s=(o=M(e[r+t],e[a+t])).a,p=o.b,o=M(i,s),e[l+t]=o.a,e[r+t]=o.b,o=M(h,p),e[n+t]=o.a,e[a+t]=o.b}}if(r&c){let r,n=l+y;i=(r=f?m(e[l+t],e[n+t]):M(e[l+t],e[n+t])).a,e[n+t]=r.b,e[l+t]=i}}if(l&c){let l=u,a=u+n*(r-o);for(;l<=a;l+=b){let r,n=l+v;i=(r=f?m(e[l+t],e[n+t]):M(e[l+t],e[n+t])).a,e[n+t]=r.b,e[l+t]=i}}o=c,c>>=1}}(n,e.start+r,e.nx,e.size,e.ny,e.nx*e.size,s)}var h=a;for(let e=0;e<h;++e)n[e]=f[n[e]];let p=0,v=new Uint8Array(n.buffer.byteLength);for(let t=0;t<e.lines;t++)for(let t=0;t<e.channels;t++){let e=i[t],r=e.nx*e.size,l=new Uint8Array(n.buffer,2*e.end,2*r);v.set(l,p),p+=2*r,e.end+=r}return new DataView(v.buffer)}var z=r(30741);(a=u||(u={}))[a.Float=0]="Float",a[a.HalfFloat=1]="HalfFloat";class _{}async function L(e,t,r,n){let l={size:0,viewer:t,array:new Uint8Array(t.buffer),offset:r,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,channels:e.channels.length,channelLineOffsets:{},scanOrder:()=>0,bytesPerLine:0,outLineWidth:0,lines:0,scanlineBlockSize:0,inputSize:null,type:0,uncompress:null,getter:()=>0,format:5,outputChannels:0,decodeChannels:{},blockCount:null,byteArray:null,linearSpace:!1,textureType:0};switch(e.compression){case i.NO_COMPRESSION:l.lines=1,l.uncompress=P;break;case i.RLE_COMPRESSION:l.lines=1,l.uncompress=R;break;case i.ZIPS_COMPRESSION:l.lines=1,l.uncompress=k,await z.w1.LoadScriptAsync(_.FFLATEUrl);break;case i.ZIP_COMPRESSION:l.lines=16,l.uncompress=k,await z.w1.LoadScriptAsync(_.FFLATEUrl);break;case i.PIZ_COMPRESSION:l.lines=32,l.uncompress=T;break;case i.PXR24_COMPRESSION:l.lines=16,l.uncompress=N,await z.w1.LoadScriptAsync(_.FFLATEUrl);break;default:throw Error(i[e.compression]+" is unsupported")}l.scanlineBlockSize=l.lines;let a={};for(let t of e.channels)switch(t.name){case"Y":case"R":case"G":case"B":case"A":a[t.name]=!0,l.type=t.pixelType}let o=!1;if(a.R&&a.G&&a.B)o=!a.A,l.outputChannels=4,l.decodeChannels={R:0,G:1,B:2,A:3};else if(a.Y)l.outputChannels=1,l.decodeChannels={Y:0};else throw Error("EXRLoader.parse: file contains unsupported data channels.");if(1===l.type)switch(n){case u.Float:l.getter=S,l.inputSize=2;break;case u.HalfFloat:l.getter=d,l.inputSize=2}else if(2===l.type)switch(n){case u.Float:l.getter=b,l.inputSize=4;break;case u.HalfFloat:l.getter=E,l.inputSize=4}else throw Error("Unsupported pixelType "+l.type+" for "+e.compression);l.blockCount=l.height/l.scanlineBlockSize;for(let e=0;e<l.blockCount;e++)!function(e,t){let r;"getBigInt64"in DataView.prototype?e.getBigInt64(t.value,!0):(e.getUint32(t.value+4,!0),e.getUint32(t.value,!0)),t.value+=8}(t,r);let f=l.width*l.height*l.outputChannels;switch(n){case u.Float:l.byteArray=new Float32Array(f),l.textureType=1,o&&l.byteArray.fill(1,0,f);break;case u.HalfFloat:l.byteArray=new Uint16Array(f),l.textureType=2,o&&l.byteArray.fill(15360,0,f);break;default:throw Error("Unsupported type: "+n)}let s=0;for(let t of e.channels)void 0!==l.decodeChannels[t.name]&&(l.channelLineOffsets[t.name]=s*l.width),s+=2*t.pixelType;return l.bytesPerLine=l.width*s,l.outLineWidth=l.width*l.outputChannels,"INCREASING_Y"===e.lineOrder?l.scanOrder=e=>e:l.scanOrder=e=>l.height-1-e,4==l.outputChannels?(l.format=5,l.linearSpace=!0):(l.format=6,l.linearSpace=!1),l}_.DefaultOutputType=u.HalfFloat,_.FFLATEUrl="https://unpkg.com/fflate@0.8.2";class F{constructor(){this.supportCascades=!1}loadCubeData(e,t,r,n,l){throw".exr not supported in Cube."}async loadData(e,t,r){let n=new DataView(e.buffer),l={value:0},a=function(e,t){if(0x1312f76!=e.getUint32(0,!0))throw Error("Incorrect OpenEXR format");let r=e.getUint8(4),n=e.getUint8(5);t.value=8;let l={},a=!0;for(;a;){let r=h(e.buffer,t);if(r){let n=h(e.buffer,t),a=w(e,t),i=function(e,t,r,n){switch(r){case"string":case"stringvector":case"iccProfile":var l=e.buffer;let a=new TextDecoder().decode(new Uint8Array(l).slice(t.value,t.value+n));return t.value=t.value+n,a;case"chlist":return function(e,t,r){let n=t.value,l=[];for(;t.value<n+r-1;){let r=h(e.buffer,t),n=p(e,t),a=y(e,t);t.value+=3;let i=p(e,t),o=p(e,t);l.push({name:r,pixelType:n,pLinear:a,xSampling:i,ySampling:o})}return t.value+=1,l}(e,t,n);case"chromaticities":return function(e,t){let r=b(e,t),n=b(e,t),l=b(e,t),a=b(e,t),i=b(e,t),o=b(e,t);return{redX:r,redY:n,greenX:l,greenY:a,blueX:i,blueY:o,whiteX:b(e,t),whiteY:b(e,t)}}(e,t);case"compression":return y(e,t);case"box2i":let i=p(e,t);return{xMin:i,yMin:p(e,t),xMax:p(e,t),yMax:p(e,t)};case"lineOrder":return o[y(e,t)];case"float":return b(e,t);case"v2f":return[b(e,t),b(e,t)];case"v3f":return[b(e,t),b(e,t),b(e,t)];case"int":return p(e,t);case"rational":return[p(e,t),w(e,t)];case"timecode":return[w(e,t),w(e,t)];case"preview":return t.value+=n,"skipped";default:t.value+=n;return}}(e,t,n,a);void 0===i?f.Y.Warn(`Unknown header attribute type ${n}'.`):l[r]=i}else a=!1}if((-5&n)!=0)throw Error("Unsupported file format");return{version:r,spec:{singleTile:!!(2&n),longName:!!(4&n),deepFormat:!!(8&n),multiPart:!!(16&n)},...l}}(n,l),i=await L(a,n,l,_.DefaultOutputType);!function(e,t,r,n){let l={value:0};for(let a=0;a<e.height/e.scanlineBlockSize;a++){let i=p(r,n)-t.dataWindow.yMin;e.size=w(r,n),e.lines=i+e.scanlineBlockSize>e.height?e.height-i:e.scanlineBlockSize;let o=e.size<e.lines*e.bytesPerLine&&e.uncompress?e.uncompress(e):P(e);n.value+=e.size;for(let r=0;r<e.scanlineBlockSize;r++){let n=a*e.scanlineBlockSize,i=r+e.scanOrder(n);if(i>=e.height)continue;let u=r*e.bytesPerLine,f=(e.height-1-i)*e.outLineWidth;for(let r=0;r<e.channels;r++){let n=t.channels[r].name,a=e.channelLineOffsets[n],i=e.decodeChannels[n];if(void 0!==i){l.value=u+a;for(let t=0;t<e.width;t++){let r=f+t*e.outputChannels+i;e.byteArray&&(e.byteArray[r]=e.getter(o,l))}}}}}}(i,a,n,l),r(a.dataWindow.xMax-a.dataWindow.xMin+1,a.dataWindow.yMax-a.dataWindow.yMin+1,t.generateMipMaps,!1,()=>{let e=t.getEngine();t.format=a.format,t.type=i.textureType,t.invertY=!1,t._gammaSpace=!a.linearSpace,i.byteArray&&e._uploadDataToTextureDirectly(t,i.byteArray,0,0,void 0,!0)})}}}}]);