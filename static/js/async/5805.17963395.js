"use strict";(self.webpackChunkdelixia=self.webpackChunkdelixia||[]).push([["5805"],{76692:function(e,t,n){n.d(t,{Q:()=>i});var o=n(54520);class i extends o.Pd{constructor(e,t){super(e,t,3)}connect(e){if(!this._connect(e))throw Error("Connect failed")}disconnect(e){if(!this._disconnect(e))throw Error("Disconnect failed")}disconnectAll(){if(!this._downstreamNodes)throw Error("Disconnect failed");let e=this._downstreamNodes.values();for(let t=e.next();!t.done;t=e.next())if(!this._disconnect(t.value))throw Error("Disconnect failed")}}},83298:function(e,t,n){n.d(t,{AB:()=>a,Hf:()=>r,Jo:()=>s,hx:()=>u});var o=n(64594),i=n(76692);class s extends i.Q{constructor(e){super("Analyzer",e)}setOptions(e){this.fftSize=e.analyzerFFTSize??o.nB.fftSize,this.minDecibels=e.analyzerMinDecibels??o.nB.minDecibels,this.maxDecibels=e.analyzerMaxDecibels??o.nB.maxDecibels,this.smoothing=e.analyzerSmoothing??o.nB.smoothing}}function a(e){return e.getSubNode("Analyzer")}function r(e,t){return a(e)?.[t]??o.nB[t]}function u(e,t,n){e.callOnSubNode("Analyzer",e=>{e[t]=n})}},66275:function(e,t,n){n.d(t,{Ls:()=>r,Ye:()=>u,ZH:()=>d,zV:()=>a});var o=n(85898),i=n(61934),s=n(76692);class a extends s.Q{constructor(e){super("Spatial",e),this._attacherComponent=null}get isAttached(){return null!==this._attacherComponent&&this._attacherComponent.isAttached}attach(e,t,n){this.detach(),this._attacherComponent||(this._attacherComponent=new o.m(this)),this._attacherComponent.attach(e,t,n)}detach(){this._attacherComponent?.detach()}dispose(){super.dispose(),this._attacherComponent?.dispose(),this._attacherComponent=null}setOptions(e){this.coneInnerAngle=e.spatialConeInnerAngle??i.pC.coneInnerAngle,this.coneOuterAngle=e.spatialConeOuterAngle??i.pC.coneOuterAngle,this.coneOuterVolume=e.spatialConeOuterVolume??i.pC.coneOuterVolume,this.distanceModel=e.spatialDistanceModel??i.pC.distanceModel,this.maxDistance=e.spatialMaxDistance??i.pC.maxDistance,this.minDistance=e.spatialMinDistance??i.pC.minDistance,this.panningModel=e.spatialPanningModel??i.pC.panningModel,this.rolloffFactor=e.spatialRolloffFactor??i.pC.rolloffFactor,e.spatialPosition&&(this.position=e.spatialPosition.clone()),e.spatialRotationQuaternion?this.rotationQuaternion=e.spatialRotationQuaternion.clone():e.spatialRotation?this.rotation=e.spatialRotation.clone():this.rotationQuaternion=i.pC.rotationQuaternion.clone(),this.update()}update(){this.isAttached?this._attacherComponent?.update():(this._updatePosition(),this._updateRotation())}}function r(e){return e.getSubNode("Spatial")}function u(e,t){return r(e)?.[t]??i.pC[t]}function d(e,t,n){e.callOnSubNode("Spatial",e=>{e[t]=n})}},80349:function(e,t,n){n.d(t,{S3:()=>s,_u:()=>a,iE:()=>u,vV:()=>r});var o=n(76692),i=n(51807);class s extends o.Q{constructor(e){super("Stereo",e)}setOptions(e){this.pan=e.stereoPan??i.So.pan}}function a(e){return e.getSubNode("Stereo")}function r(e,t){return a(e)?.[t]??i.So[t]}function u(e,t,n){e.callOnSubNode("Stereo",e=>{e[t]=n})}},12737:function(e,t,n){n.d(t,{TT:()=>s,gB:()=>r,nP:()=>a});var o=n(76692);let i={volume:1};class s extends o.Q{constructor(e){super("Volume",e)}setOptions(e){this.volume=e.volume??i.volume}}function a(e){return e.getSubNode("Volume")}function r(e,t){return a(e)?.[t]??i[t]}},64594:function(e,t,n){n.d(t,{FU:()=>i,nB:()=>o,vw:()=>s});let o={fftSize:2048,minDecibels:-100,maxDecibels:-30,smoothing:.8};function i(e){return e.analyzerEnabled||void 0!==e.analyzerFFTSize||void 0!==e.analyzerMinDecibels||void 0!==e.analyzerMaxDecibels||void 0!==e.analyzerSmoothing}class s{get frequencyBinCount(){return this.fftSize/2}}},61934:function(e,t,n){n.d(t,{pC:()=>i,xe:()=>s,zD:()=>a});var o=n(58098);let i={coneInnerAngle:6.28318530718,coneOuterAngle:6.28318530718,coneOuterVolume:0,distanceModel:"linear",maxDistance:1e4,minDistance:1,panningModel:"equalpower",position:o.P.Zero(),rolloffFactor:1,rotation:o.P.Zero(),rotationQuaternion:new o._f};function s(e){return e.spatialEnabled||void 0!==e.spatialAutoUpdate||void 0!==e.spatialConeInnerAngle||void 0!==e.spatialConeOuterAngle||void 0!==e.spatialConeOuterVolume||void 0!==e.spatialDistanceModel||void 0!==e.spatialMaxDistance||void 0!==e.spatialMinDistance||void 0!==e.spatialMinUpdateTime||void 0!==e.spatialPanningModel||void 0!==e.spatialPosition||void 0!==e.spatialRolloffFactor||void 0!==e.spatialRotation||void 0!==e.spatialRotationQuaternion}class a{}},51807:function(e,t,n){n.d(t,{So:()=>o,ZY:()=>i,wY:()=>s});let o={pan:0};function i(e){return e.stereoEnabled||void 0!==e.stereoPan}class s{}},14581:function(e,t,n){n.d(t,{PR:()=>d,fG:()=>h,uy:()=>u});var o=n(11597),i=n(64594),s=n(83298);let a=null,r=null;function u(){return a||(a=new Uint8Array),a}function d(){return r||(r=new Float32Array),r}class h extends i.vw{constructor(e){super(),this._subGraph=e}get fftSize(){return(0,s.Hf)(this._subGraph,"fftSize")}set fftSize(e){(0,s.hx)(this._subGraph,"fftSize",e)}get isEnabled(){return null!==(0,s.AB)(this._subGraph)}get minDecibels(){return(0,s.Hf)(this._subGraph,"minDecibels")}set minDecibels(e){(0,s.hx)(this._subGraph,"minDecibels",e)}get maxDecibels(){return(0,s.Hf)(this._subGraph,"maxDecibels")}set maxDecibels(e){(0,s.hx)(this._subGraph,"maxDecibels",e)}get smoothing(){return(0,s.Hf)(this._subGraph,"smoothing")}set smoothing(e){(0,s.hx)(this._subGraph,"smoothing",e)}dispose(){let e=(0,s.AB)(this._subGraph);e&&(this._subGraph.removeSubNode(e),e.dispose())}async enableAsync(){return(0,s.AB)(this._subGraph)||await this._subGraph.createAndAddSubNode("Analyzer"),Promise.resolve()}getByteFrequencyData(){let e=(0,s.AB)(this._subGraph);return e?e.getByteFrequencyData():(o.Y.Warn("AudioAnalyzer not enabled"),this.enableAsync(),u())}getFloatFrequencyData(){let e=(0,s.AB)(this._subGraph);return e?e.getFloatFrequencyData():(o.Y.Warn("AudioAnalyzer not enabled"),this.enableAsync(),d())}}},78220:function(e,t,n){n.d(t,{D:()=>s});var o=n(51807),i=n(80349);class s extends o.wY{constructor(e){super(),this._subGraph=e}get pan(){return(0,i.vV)(this._subGraph,"pan")}set pan(e){(0,i.iE)(this._subGraph,"pan",e)}}},16179:function(e,t,n){n.d(t,{n:()=>c});class o{constructor(){this._createSubNodePromises={},this._isDisposed=!1,this._subNodes={},this._onSubNodeDisposed=e=>{delete this._subNodes[e.name],this._onSubNodesChanged()}}callOnSubNode(e,t){let n=this.getSubNode(e);if(n){t(n);return}this._createSubNodePromisesResolved().then(()=>{let n=this.getSubNode(e);if(n){t(n);return}this.createAndAddSubNode(e).then(e=>{t(e)})})}createAndAddSubNode(e){var t;return(t=this._createSubNodePromises)[e]||(t[e]=this._createSubNode(e).then(e=>(this._addSubNode(e),e))),this._createSubNodePromises[e]}dispose(){for(let e of(this._isDisposed=!0,Object.values(this._subNodes)))e.dispose();this._subNodes={},this._createSubNodePromises={}}getSubNode(e){return this._subNodes[e]??null}async removeSubNode(e){await this._createSubNodePromisesResolved();let t=e.name;this._subNodes[t]&&delete this._subNodes[t],delete this._createSubNodePromises[t],this._onSubNodesChanged()}_createSubNodePromisesResolved(){return Promise.all(Object.values(this._createSubNodePromises))}_addSubNode(e){if(this._isDisposed){e.dispose();return}this._subNodes[e.name]=e,e.onDisposeObservable.addOnce(this._onSubNodeDisposed),this._onSubNodesChanged()}}var i=n(83298),s=n(12737),a=n(64594);async function r(e){return new u(e)}class u extends s.TT{constructor(e){super(e),this._volume=1,this.node=new GainNode(e._audioContext)}get volume(){return this._volume}set volume(e){this._volume=e,this.engine._setAudioParam(this.node.gain,e)}get _inNode(){return this.node}get _outNode(){return this.node}_connect(e){return!!super._connect(e)&&(e._inNode&&this.node.connect(e._inNode),!0)}_disconnect(e){return!!super._disconnect(e)&&(e._inNode&&this.node.disconnect(e._inNode),!0)}getClassName(){return"_VolumeWebAudioSubNode"}}var d=n(14581);async function h(e){return new l(e)}class l extends i.Jo{constructor(e){super(e),this._byteFrequencyData=null,this._floatFrequencyData=null,this._analyzerNode=new AnalyserNode(e._audioContext)}get fftSize(){return this._analyzerNode.fftSize}set fftSize(e){e!==this._analyzerNode.fftSize&&(this._analyzerNode.fftSize=e,this._clearArrays())}get _inNode(){return this._analyzerNode}get minDecibels(){return this._analyzerNode.minDecibels}set minDecibels(e){this._analyzerNode.minDecibels=e}get maxDecibels(){return this._analyzerNode.maxDecibels}set maxDecibels(e){this._analyzerNode.maxDecibels=e}get smoothing(){return this._analyzerNode.smoothingTimeConstant}set smoothing(e){this._analyzerNode.smoothingTimeConstant=e}dispose(){super.dispose(),this._clearArrays(),this._byteFrequencyData=null,this._floatFrequencyData=null,this._analyzerNode.disconnect()}getClassName(){return"_WebAudioAnalyzerSubNode"}getByteFrequencyData(){return this._byteFrequencyData&&0!==this._byteFrequencyData.length||(this._byteFrequencyData=new Uint8Array(this._analyzerNode.frequencyBinCount)),this._analyzerNode.getByteFrequencyData(this._byteFrequencyData),this._byteFrequencyData}getFloatFrequencyData(){return this._floatFrequencyData&&0!==this._floatFrequencyData.length||(this._floatFrequencyData=new Float32Array(this._analyzerNode.frequencyBinCount)),this._analyzerNode.getFloatFrequencyData(this._floatFrequencyData),this._floatFrequencyData}_clearArrays(){this._byteFrequencyData?.set((0,d.uy)()),this._floatFrequencyData?.set((0,d.PR)())}}class c extends o{constructor(e){super(),this._outputNode=null,this._owner=e}async init(e){let t=(0,a.FU)(e);if(t&&await this.createAndAddSubNode("Analyzer"),await this.createAndAddSubNode("Volume"),await this._createSubNodePromisesResolved(),t){let t=(0,i.AB)(this);if(!t)throw Error("No analyzer subnode.");t.setOptions(e)}let n=(0,s.nP)(this);if(!n)throw Error("No volume subnode.");if(n.setOptions(e),"_VolumeWebAudioSubNode"!==n.getClassName())throw Error("Not a WebAudio subnode.");if(this._outputNode=n.node,this._outputNode&&this._downstreamNodes){let e=this._downstreamNodes.values();for(let t=e.next();!t.done;t=e.next()){let e=t.value._inNode;e&&this._outputNode.connect(e)}}}get _inNode(){return this._outputNode}get _outNode(){return this._outputNode}_createSubNode(e){switch(e){case"Analyzer":return h(this._owner.engine);case"Volume":return r(this._owner.engine);default:throw Error(`Unknown subnode name: ${e}`)}}_onSubNodesChanged(){let e=(0,i.AB)(this),t=(0,s.nP)(this);e&&t&&t.connect(e)}}},60419:function(e,t,n){n.d(t,{C:()=>f});var o=n(66275),i=n(80349),s=n(12737),a=n(61934),r=n(51807),u=n(58098);let d=u.y3.Zero(),h=new u._f,l=u.P.Zero();function c(e){return e*Math.PI/180}function _(e){return 180*e/Math.PI}async function p(e){return new b(e)}class b extends o.zV{constructor(e){super(e),this._lastPosition=u.P.Zero(),this._lastRotation=u.P.Zero(),this._lastRotationQuaternion=new u._f,this.position=a.pC.position.clone(),this.rotation=a.pC.rotation.clone(),this.rotationQuaternion=a.pC.rotationQuaternion.clone(),this.node=new PannerNode(e._audioContext)}get coneInnerAngle(){return c(this.node.coneInnerAngle)}set coneInnerAngle(e){this.node.coneInnerAngle=_(e)}get coneOuterAngle(){return c(this.node.coneOuterAngle)}set coneOuterAngle(e){this.node.coneOuterAngle=_(e)}get coneOuterVolume(){return this.node.coneOuterGain}set coneOuterVolume(e){this.node.coneOuterGain=e}get distanceModel(){return this.node.distanceModel}set distanceModel(e){this.node.distanceModel=e;let t=this.node.maxDistance;this.node.maxDistance=t+.001,this.node.maxDistance=t}get minDistance(){return this.node.refDistance}set minDistance(e){this.node.refDistance=e}get maxDistance(){return this.node.maxDistance}set maxDistance(e){this.node.maxDistance=e}get panningModel(){return this.node.panningModel}set panningModel(e){this.node.panningModel=e}get rolloffFactor(){return this.node.rolloffFactor}set rolloffFactor(e){this.node.rolloffFactor=e}get _inNode(){return this.node}get _outNode(){return this.node}_updatePosition(){this._lastPosition.equalsWithEpsilon(this.position)||(this.engine._setAudioParam(this.node.positionX,this.position.x),this.engine._setAudioParam(this.node.positionY,this.position.y),this.engine._setAudioParam(this.node.positionZ,this.position.z),this._lastPosition.copyFrom(this.position))}_updateRotation(){if(this._lastRotationQuaternion.equalsWithEpsilon(this.rotationQuaternion))if(this._lastRotation.equalsWithEpsilon(this.rotation))return;else u._f.FromEulerAnglesToRef(this.rotation.x,this.rotation.y,this.rotation.z,h),this._lastRotation.copyFrom(this.rotation);else h.copyFrom(this.rotationQuaternion),this._lastRotationQuaternion.copyFrom(this.rotationQuaternion);u.y3.FromQuaternionToRef(h,d),u.P.TransformNormalToRef(u.P.RightReadOnly,d,l),this.engine._setAudioParam(this.node.orientationX,l.x),this.engine._setAudioParam(this.node.orientationY,l.y),this.engine._setAudioParam(this.node.orientationZ,l.z)}_connect(e){return!!super._connect(e)&&(e._inNode&&this.node.connect(e._inNode),!0)}_disconnect(e){return!!super._disconnect(e)&&(e._inNode&&this.node.disconnect(e._inNode),!0)}getClassName(){return"_SpatialWebAudioSubNode"}}async function m(e){return new N(e)}class N extends i.S3{constructor(e){super(e),this._pan=0,this.node=new StereoPannerNode(e._audioContext)}get pan(){return this._pan}set pan(e){this._pan=e,this.engine._setAudioParam(this.node.pan,e)}get _inNode(){return this.node}get _outNode(){return this.node}getClassName(){return"_StereoWebAudioSubNode"}_connect(e){return!!super._connect(e)&&(e._inNode&&this.node.connect(e._inNode),!0)}_disconnect(e){return!!super._disconnect(e)&&(e._inNode&&this.node.disconnect(e._inNode),!0)}}var g=n(16179);class f extends g.n{constructor(){super(...arguments),this._rootNode=null,this._inputNode=null}async init(e){await super.init(e);let t=!1,n=!1;(t=(0,a.xe)(e))&&await this.createAndAddSubNode("Spatial"),(n=(0,r.ZY)(e))&&await this.createAndAddSubNode("Stereo"),await this._createSubNodePromisesResolved(),t&&(0,o.Ls)(this)?.setOptions(e),n&&(0,i._u)(this)?.setOptions(e)}get _inNode(){return this._inputNode}_createSubNode(e){try{return super._createSubNode(e)}catch(e){}switch(e){case"Spatial":return p(this._owner.engine);case"Stereo":return m(this._owner.engine);default:throw Error(`Unknown subnode name: ${e}`)}}_onSubNodesChanged(){super._onSubNodesChanged();let e=(0,o.Ls)(this),t=(0,i._u)(this),n=(0,s.nP)(this);if(e&&"_SpatialWebAudioSubNode"!==e.getClassName()||t&&"_StereoWebAudioSubNode"!==t.getClassName()||n&&"_VolumeWebAudioSubNode"!==n.getClassName())throw Error("Not a WebAudio subnode.");e&&(e.disconnectAll(),n&&e.connect(n)),t&&(t.disconnectAll(),n&&t.connect(n)),e&&t?(this._rootNode=new GainNode(this._owner.engine._audioContext),this._rootNode.connect(e._outNode),this._rootNode.connect(t._outNode)):(this._rootNode?.disconnect(),this._rootNode=null);let a=null,r=null;if(this._rootNode?r=this._rootNode:(e?a=e:t?a=t:n&&(a=n),r=a?.node??null),this._inputNode!==r){if(this._inputNode&&this._upstreamNodes){let e=this._upstreamNodes.values();for(let t=e.next();!t.done;t=e.next())t.value._outNode?.disconnect(this._inputNode)}if(this._inputNode=r,r&&this._upstreamNodes){let e=this._upstreamNodes.values();for(let t=e.next();!t.done;t=e.next())t.value._outNode?.connect(r)}}}}},7701:function(e,t,n){n.d(t,{u:()=>r});var o=n(66275),i=n(61934);class s extends i.zD{constructor(e){super();let t=(0,o.Ls)(e);t?(this._position=t.position.clone(),this._rotation=t.rotation.clone(),this._rotationQuaternion=t.rotationQuaternion.clone()):(this._position=i.pC.position.clone(),this._rotation=i.pC.rotation.clone(),this._rotationQuaternion=i.pC.rotationQuaternion.clone(),e.createAndAddSubNode("Spatial")),this._subGraph=e}get coneInnerAngle(){return(0,o.Ye)(this._subGraph,"coneInnerAngle")??i.pC.coneInnerAngle}set coneInnerAngle(e){(0,o.ZH)(this._subGraph,"coneInnerAngle",e)}get coneOuterAngle(){return(0,o.Ye)(this._subGraph,"coneOuterAngle")}set coneOuterAngle(e){(0,o.ZH)(this._subGraph,"coneOuterAngle",e)}get coneOuterVolume(){return(0,o.Ye)(this._subGraph,"coneOuterVolume")}set coneOuterVolume(e){(0,o.ZH)(this._subGraph,"coneOuterVolume",e)}get distanceModel(){return(0,o.Ye)(this._subGraph,"distanceModel")}set distanceModel(e){(0,o.ZH)(this._subGraph,"distanceModel",e)}get isAttached(){return this._subGraph.getSubNode("Spatial")?.isAttached??!1}get maxDistance(){return(0,o.Ye)(this._subGraph,"maxDistance")??i.pC.maxDistance}set maxDistance(e){e<=0&&(e=1e-6),(0,o.ZH)(this._subGraph,"maxDistance",e)}get minDistance(){return(0,o.Ye)(this._subGraph,"minDistance")}set minDistance(e){(0,o.ZH)(this._subGraph,"minDistance",e)}get panningModel(){return(0,o.Ye)(this._subGraph,"panningModel")}set panningModel(e){(0,o.ZH)(this._subGraph,"panningModel",e)}get position(){return this._position}set position(e){this._position=e,this._updatePosition()}get rolloffFactor(){return(0,o.Ye)(this._subGraph,"rolloffFactor")}set rolloffFactor(e){(0,o.ZH)(this._subGraph,"rolloffFactor",e)}get rotation(){return this._rotation}set rotation(e){this._rotation=e,this._updateRotation()}get rotationQuaternion(){return this._rotationQuaternion}set rotationQuaternion(e){this._rotationQuaternion=e,this._updateRotation()}attach(e,t=!1,n=3){(0,o.Ls)(this._subGraph)?.attach(e,t,n)}detach(){(0,o.Ls)(this._subGraph)?.detach()}update(){let e=(0,o.Ls)(this._subGraph);e&&(e.isAttached?e.update():(this._updatePosition(e),this._updateRotation(e)))}_updatePosition(e=null){(e||(e=(0,o.Ls)(this._subGraph)))&&(e.position.equalsWithEpsilon(this._position)||(e.position.copyFrom(this._position),e._updatePosition()))}_updateRotation(e=null){(e||(e=(0,o.Ls)(this._subGraph)))&&(e.rotationQuaternion.equalsWithEpsilon(this._rotationQuaternion)?e.rotation.equalsWithEpsilon(this._rotation)||(e.rotation.copyFrom(this._rotation),e._updateRotation()):(e.rotationQuaternion.copyFrom(this._rotationQuaternion),e._updateRotation()))}}var a=n(29748);class r extends s{constructor(e,t,n){super(e),this._updaterComponent=new a.e(this,t,n)}get minUpdateTime(){return this._updaterComponent.minUpdateTime}set minUpdateTime(e){this._updaterComponent.minUpdateTime=e}dispose(){this._updaterComponent.dispose(),this._updaterComponent=null}}}}]);